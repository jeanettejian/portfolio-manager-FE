<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Portfolio Manager</title>
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <link rel="stylesheet" href="static/bootstrap.min.css">
    <link rel="stylesheet" href="static/adminlte.min.css">
    <link rel="stylesheet" href="static/skin-blue.min.css">
    <link rel="stylesheet" href="static/google_fonts.css">
    <link rel="stylesheet" href="static/font-awesome/css/fontawesome.css">
    <link rel="stylesheet" href="static/font-awesome/css/solid.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans&display=swap" rel="stylesheet">

    <script src="static/jquery.min.js"></script>
    <script src="static/bootstrap.min.js"></script>
    <script src="static/adminlte.min.js"></script>
    <script src="static/edu-modal-alert-confirm.js"></script>

    <style>
        .middle-box {
            position: absolute;
            left: 50%;
            transform: translate(-50%, 0);
        }

        .container {
            height: 100vh;
            text-align: center;
            display: flex;
            justify-content: center;
        }

        .chart-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
        }

        .chart-div {
            flex: 1;
            margin: 10px;
            border: 1px solid #ccc;
            height: 100%;
            width: 100%;
        }
    </style>

</head>

<body class="hold-transition skin-blue sidebar-mini">
    <div class="wrapper">

        <!-- Main Header -->
        <header class="main-header">

            <!-- Logo -->
            <a href="#" class="logo">
                <span class="logo-lg"><b>Portfolio Manager</b></span>
            </a>

            <!-- Header Navbar -->
            <nav class="navbar navbar-static-top" role="navigation"></nav>
        </header>

        <!-- Left sidebar -->
        <aside class="main-sidebar">

            <!-- sidebar: style can be found in sidebar.less -->
            <section class="sidebar">

                <!-- Sidebar user panel -->
                <div class="user-panel">
                    <div class="pull-left image">
                        <img src="static/user.png" class="img-circle" alt="User Image">
                    </div>
                    <div class="pull-left info">
                        <p>Welcome, user!</p>
                        <a href="#"><i class="fa-solid fa-circle text-success"></i> Active</a>
                    </div>
                </div>

                <!-- Sidebar Menu -->
                <ul class="sidebar-menu" data-widget="tree" id="mainsidebar">
                    <p class="header" style="background-color:steelblue;padding:3px"></p>
                    <li id="portfolio"><a href="portfolio.html"><i class="fa-solid fa-pie-chart"></i>
                            <span>Portfolio</span></a></li>
                    <li id="Performance"><a href="performance.html"><i class="fa-solid fa-line-chart"></i>
                            <span>Performance</span></a>
                    </li>
                    <li id="manage" class="treeview">
                        <a href="#">
                            <i class="fa-solid fa-pen"></i> <span>Manage</span>
                            <span class="pull-right-container">
                                <i class="fa fa-angle-left pull-right"></i>
                            </span>
                        </a>
                        <ul class="treeview-menu" id="subsidebar">
                            <li id="manage"><a href="modify.html"><i class="fa fa-circle-o"></i>
                                    <span>Modify Portfolio</span></a></li>
                            <li id="manage"><a href="search.html"><i class="fa fa-circle-o"></i>
                                    <span>Search Asset</span></a></li>
                        </ul>
                    </li>
                </ul>
                <script src="js/treeview.js"></script>
            </section>
        </aside>

        <!-- specific pages, main body -->

        <div class="content-wrapper">
            <div class="container">
                <div class="col-md-4" style="margin-top:10px;">
                    <div class="box">
                        <div class="box-header with-border">
                            <h3 class="box-title">Table</h3>
                        </div>

                        <div class="box-body">
                            <table class="table no-margin text-center">
                                <thead>
                                    <tr>
                                        <th>Stock</th>
                                        <th>Shares</th>
                                        <th>Value</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>AAPL</td>
                                        <td>1000</td>
                                        <td>99999</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="col-md-8" style="display:flex;flex-direction:column;margin-top:10px;">
                    <div class="box">
                        <div class="box-header with-border">
                            <h3 class="box-title">Sell</h3>
                        </div>
                        <div class="box-body">
                            <form class="form-horizontal" id="sell-form">
                                <div class="form-group" style="display:flex;justify-content:center;">
                                    <label class="col-sm-2 control-label">Asset</label>
                                    <div class="col-xs-5">
                                        <select class="form-control" id="stock-name">
                                            <option value="AAPL">AAPL</option>
                                            <option value="GOOGL">GOOGL</option>
                                            <option value="AMZN">AMZN</option>
                                            <option value="TSLA">TSLA</option>
                                            <option value="MSFT">MSFT</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group" style="display:flex;justify-content:center;">
                                    <label class="col-sm-2 control-label">Share</label>
                                    <div class="col-xs-5">
                                        <input type="text" class="form-control" id="sell-amount" placeholder="Number of shares">
                                    </div>
                                </div>
                        </div>
                        <div class="box-footer">
                            <button type="button" class="btn btn-primary" id="sell-button">Sell</button>
                        </div>
                        <div id="result-message"></div>
                        </form>
                    </div>
                        
               

                        <script>
                            // Backend URL for selling stocks
                            const sellurl = "http://localhost:8081/artists/sellStocks";

                            // Function to sell stock shares
                            async function sellShares() {
                                const stockNameInput = document.getElementById('stock-name');
                                const sellAmountInput = document.getElementById('sell-amount');

                                const stockName = stockNameInput.value.trim();
                                const sellAmount = parseInt(sellAmountInput.value.trim());

                                // Validate the stock name and sell amount
                                if (!stockName) {
                                    alert('Please enter a valid stock ticker.');
                                    return;
                                }
                                if (isNaN(sellAmount) || sellAmount <= 0) {
                                    alert('Please enter a valid number of shares to sell.');
                                    return;
                                }

                                // Data to be sent to the backend
                                const data = {
                                    stock_name: stockName, // Dynamic stock ticker from user input
                                    shares: sellAmount
                                };

                                try {
                                    const response = await fetch(sellurl, {
                                        method: 'POST',
                                        headers: {
                                            'Content-Type': 'application/json'
                                        },
                                        body: JSON.stringify(data)
                                    });

                                    const result = await response.json();

                                    // Check for a successful response
                                    if (response.ok) {
                                        document.getElementById('result-message').innerText = result.message;
                                    } else {
                                        document.getElementById('result-message').innerText = 'Error: ' + result.message;
                                    }

                                    // Optionally, clear the input fields
                                    stockNameInput.value = '';
                                    sellAmountInput.value = '';

                                } catch (error) {
                                    console.error('Error:', error);
                                    document.getElementById('result-message').innerText = 'Error selling shares. Please try again.';
                                }
                            }

                            // Adding click event listener to the sell button
                            document.getElementById('sell-button').addEventListener('click', sellShares);
                        </script>

                    
                

                    <div class="box">
                        <div class="box-header with-border">
                            <h3 class="box-title">Buy</h3>
                        </div>
                        <div class="box-body">
                            <form class="form-horizontal">
                                <div class="form-group" style="display:flex;justify-content:center;">
                                    <label class="col-sm-2 control-label">Asset</label>
                                    <div class="col-xs-5">
                                        <select class="form-control">
                                            <option>option 1</option>
                                            <option>option 2</option>
                                            <option>option 3</option>
                                            <option>option 4</option>
                                            <option>option 5</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group" style="display:flex;justify-content:center;">
                                    <label class="col-sm-2 control-label">Share</label>
                                    <div class="col-xs-5">
                                        <input type="text" class="form-control" id="share_num"
                                            placeholder="Number of shares">
                                    </div>
                                </div>
                        </div>
                        <div class="box-footer">
                            <button type="submit" class="btn btn-primary">Buy</button>
                        </div>
                        </form>
                    </div>
                </div>
            </div>

            <script src="https://cdn.jsdelivr.net/npm/echarts@5.1.2/dist/echarts.min.js"></script>
            <script src="js/linechart.js"></script>
        </div>

        <!-- Main Footer -->
        <footer class="main-footer">
            <div class="pull-right hidden-xs">
            </div>
        </footer>

        <!-- background -->
        <div class="control-sidebar-bg"></div>
    </div>

</body>

</html>